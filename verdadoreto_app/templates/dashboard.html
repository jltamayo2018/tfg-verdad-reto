{% extends "base.html" %}
{% load pack_extras %}
{% block title %}Mis packs{% endblock %}

{% block content %}
  <div class="container">
    <h2 class="neon-title">Mis packs</h2>

    <p>
      <a class="btn btn-primary btn-wide" href="{% url 'pack_create' %}">
        + Crear nuevo pack
      </a>
    </p>

    {% if packs %}
      <section class="packs-grid" aria-label="Cuadr√≠cula de packs">
        {% for p in packs %}
          <!-- Contenedor relativo para superponer los botones sin meterlos dentro del <a> -->
          <div class="pack-card-wrap" style="position:relative;">
            <!-- Al clickear sobre la tarjeta te lleva a la p√°gina p√∫blica -->
            <a href="{% url 'publico_por_token' p.token %}"
               class="pack-card neon-card"
               aria-label="Jugar pack {{ p.name }}">
              <header class="pack-card__head">
                <h3 class="pack-card__title">{{ p.name }}</h3>
              </header>
              
              <!-- Emoji centrado (toma el emoji del label de la choice) -->
              {% with label=p.get_category_display %}
                <div class="pack-card__emoji">{{ label|slice:":1" }}</div>
              {% endwith %}

              <!-- Estrellas abajo-izquierda -->
              <div class="pack-card__level">
                <span class="stars">{% stars_compact p.level 5 %}</span>
              </div>
            </a>

            <!-- Botones flotantes (editar y eliminar pack) -->
            <div class="pack-tools" style="position:absolute; right:12px; bottom:12px; display:inline-flex; gap:8px; z-index:2;">
              <a href="{% url 'pack_detail' p.pk %}"
                 class="icon-btn"
                 title="Detalles del pack"
                 aria-label="Editar nombre">
                <span aria-hidden="true">‚úèÔ∏è</span>
              </a>

              <a href="{% url 'pack_delete' p.pk %}"
                class="icon-btn danger"
                title="Eliminar pack"
                aria-label="Eliminar pack">
                <span aria-hidden="true">üóëÔ∏è</span>
              </a>

            </div>
          </div>
        {% endfor %}
      </section>
    {% else %}
      <div class="card">
        <p class="muted">A√∫n no tienes packs. Crea el primero.</p>
      </div>
    {% endif %}
  </div>
{% endblock %}
